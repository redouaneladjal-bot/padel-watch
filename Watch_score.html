<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Padel Watch</title>

<style>
:root{
  --safe:14px;
  --a:#00f2ff;
  --b:#ff4fd8;
}

*{box-sizing:border-box;font-family:system-ui,Arial;}

html,body{
  margin:0;
  height:100%;
  background:radial-gradient(circle at top,#1a1f3c,#02020a);
  color:white;
}

body{
  display:flex;
  justify-content:center;
  align-items:center;
}

/* Safe round padding */
.app{
  width:100%;
  height:100%;
  padding:calc(10px + var(--safe));
  display:grid;
  grid-template-rows:auto 1fr auto;
  gap:8px;
}

/* Top Score */
.top{
  background:rgba(0,0,0,.45);
  border-radius:18px;
  padding:6px;
  display:grid;
  grid-template-columns:1.2fr repeat(3,1fr) 1fr;
  grid-template-rows:repeat(2,1fr);
  gap:4px;
  border:1px solid rgba(255,255,255,.15);
}

.cell{
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  font-size:13px;
  background:rgba(255,255,255,.08);
  border-radius:10px;
}

.teamA{color:var(--a);}
.teamB{color:var(--b);}


/* Main round zone */
.main{
  position:relative;
  background:radial-gradient(circle,#0b0f2b,#000);
  border-radius:50%;
  overflow:hidden;
  box-shadow:0 0 30px rgba(0,0,0,.8);
  border:1px solid rgba(255,255,255,.15);
  display:grid;
  grid-template-columns:1fr 1fr;
}

/* Left / Right */
.zone{
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:22px;
  font-weight:900;
  letter-spacing:1px;
  user-select:none;
}

.zoneA{
  background:radial-gradient(circle at left,var(--a),transparent 70%);
}

.zoneB{
  background:radial-gradient(circle at right,var(--b),transparent 70%);
}

.centerLine{
  position:absolute;
  top:0;bottom:0;left:50%;
  width:2px;
  background:rgba(255,255,255,.2);
}

/* Serve */
.ball{
  position:absolute;
  top:8px;
  width:18px;
  height:18px;
  border-radius:50%;
  background:radial-gradient(circle,#fff,#ffcc55);
  display:none;
  box-shadow:0 0 10px gold;
}

.left{left:8px;}
.right{right:8px;}
.show{display:block;}


/* Bottom bar */
.bottom{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:8px;
}

.btn{
  background:linear-gradient(145deg,#111,#000);
  border-radius:999px;
  height:42px;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:18px;
  border:1px solid rgba(255,255,255,.15);
  box-shadow:0 6px 14px rgba(0,0,0,.8);
}

.btn:active{transform:scale(.95);}

.lockOn{background:#400;}

/* Hint */
.hint{
  position:absolute;
  bottom:60px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.7);
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  opacity:0;
}

.showHint{opacity:1;}
</style>
</head>

<body>

<div class="app">

<!-- TOP -->
<div class="top">
  <div class="cell teamA">TEAM A</div>
  <div class="cell" id="a1">0</div>
  <div class="cell" id="a2">0</div>
  <div class="cell" id="a3">0</div>
  <div class="cell" id="ap">0</div>

  <div class="cell teamB">TEAM B</div>
  <div class="cell" id="b1">0</div>
  <div class="cell" id="b2">0</div>
  <div class="cell" id="b3">0</div>
  <div class="cell" id="bp">0</div>
</div>

<!-- MAIN -->
<div class="main">

  <div class="zone zoneA" id="za">TEAM A</div>
  <div class="zone zoneB" id="zb">TEAM B</div>

  <div class="centerLine"></div>

  <div class="ball" id="ballA"></div>
  <div class="ball" id="ballB"></div>

  <div class="hint" id="hint">üîí</div>

</div>

<!-- BOTTOM -->
<div class="bottom">

  <div class="btn" id="lock">üîí</div>
  <div class="btn" id="undo">‚Ü©Ô∏è</div>
  <div class="btn" id="reset">‚ü≤</div>

</div>

</div>

<script>
(()=>{
/* Best of 3 */
const winSets=2;
const maxSets=3;

let st={
  locked:false,
  finished:false,

  pts:[0,0],
  games:[[0,0],[0,0],[0,0]],
  set:0,

  tb:false,
  tbp:[0,0],

  won:[0,0],

  serve:0,
  side:0,

  hist:[]
};

const $=id=>document.getElementById(id);

const ui={
 a:[$("a1"),$("a2"),$("a3")],
 b:[$("b1"),$("b2"),$("b3")],
 ap:$("ap"),bp:$("bp"),

 za:$("za"),zb:$("zb"),

 ba:$("ballA"),bb:$("ballB"),

 lock:$("lock"),undo:$("undo"),reset:$("reset"),

 hint:$("hint")
};

function snap(){
 st.hist.push(JSON.parse(JSON.stringify(st)));
 if(st.hist.length>60)st.hist.shift();
}

function undo(){
 if(!st.hist.length)return;
 st=st.hist.pop();
 render();
}

function reset(){
 snap();
 st={
  locked:false,finished:false,
  pts:[0,0],
  games:[[0,0],[0,0],[0,0]],
  set:0,tb:false,tbp:[0,0],
  won:[0,0],
  serve:0,side:0,
  hist:st.hist
 };
 render();
}

function score(p){
 return ["0","15","30","40"][Math.min(p,3)];
}

function winGame(t){
 st.games[st.set][t]++;
 st.pts=[0,0];

 st.serve^=1;
 st.side^=1;

 const g=st.games[st.set];
 if(g[0]==6&&g[1]==6){
  st.tb=true;st.tbp=[0,0];
 }

 if(!st.tb){
  if((Math.max(...g)>=6)&&Math.abs(g[0]-g[1])>=2){
   endSet(g[0]>g[1]?0:1);
  }
 }
}

function endSet(t){
 st.won[t]++;
 st.pts=[0,0];
 st.tb=false;st.tbp=[0,0];

 if(st.won[t]>=winSets){
  st.finished=true;
  return;
 }

 if(st.set<maxSets-1)st.set++;
}

function point(t){
 if(st.locked||st.finished)return;

 snap();

 if(st.tb){
  st.tbp[t]++;

  if(Math.max(...st.tbp)>=7 &&
     Math.abs(st.tbp[0]-st.tbp[1])>=2){

   st.games[st.set]=[
    st.tbp[0]>st.tbp[1]?7:6,
    st.tbp[1]>st.tbp[0]?7:6
   ];
   endSet(t);
  }
  render();return;
 }

 st.pts[t]++;

 if(st.pts[t]>=4){
  winGame(t);
 }

 render();
}

function render(){

 for(let i=0;i<3;i++){
  ui.a[i].textContent=st.games[i][0];
  ui.b[i].textContent=st.games[i][1];
 }

 if(st.tb){
  ui.ap.textContent=st.tbp[0];
  ui.bp.textContent=st.tbp[1];
 }else{
  ui.ap.textContent=score(st.pts[0]);
  ui.bp.textContent=score(st.pts[1]);
 }

 ui.ba.className="ball";
 ui.bb.className="ball";

 let el=st.serve?ui.bb:ui.ba;
 el.classList.add("show");
 el.classList.add(st.side?"right":"left");

 ui.lock.textContent=st.locked?"üîí":"üîì";
 ui.lock.classList.toggle("lockOn",st.locked);
}

function hint(t){
 ui.hint.textContent=t;
 ui.hint.classList.add("showHint");
 setTimeout(()=>ui.hint.classList.remove("showHint"),500);
}

/* Events */

ui.za.onclick=()=>point(0);
ui.zb.onclick=()=>point(1);

ui.lock.onclick=()=>{
 snap();
 st.lock=!st.locked;
 hint(st.locked?"üîí":"üîì");
 render();
};

ui.undo.onclick=()=>undo();
ui.reset.onclick=()=>reset();

render();
})();
</script>

</body>
</html>
